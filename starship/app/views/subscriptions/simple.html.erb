<% javascript_include_tag :defaults %>

<p>Please select below for which events you want to receive notifications.</p>

<% simple_subscriptions = 0 %>
<table class="defaultTable">

<% form_for :subscription, :url => { :action => :modify_simple_subscriptions } do |form| %>
<% for group_id in @abstraction_groups.keys %>

  <tr><td colspan="5"><h3><%= @abstraction_groups[group_id] %> </h3></td></tr>
  
  <% for abstraction in @abstractions[group_id].values %>
  
  <tr style="border-width: 1px; border-style: solid; border-color: #e0e0e0; "><td valign='top' width="30%">
  <b><%= abstraction.summary %></b> <br/>
  <i><%= abstraction.description %></i> 
  </td>
  <td>
  
  <table class="defaultTable">
  <% for filter_abstract in abstraction.filterabstracts.values %>
  
    <!-- form part for abstract id: <%= abstraction.id %> filter_abstract id: <%= filter_abstract.id %> -->
  
    <tr><td valign='top' width="20">
    <% subscription = @person.subscribed_to_abstraction( group_id, abstraction.id, filter_abstract.id ) %>
    <%= check_box_tag "#{abstraction.id}||#{filter_abstract.id}", "1", subscription %>
    </td>
    <td valign='top' width="60%">
    <%= filter_abstract.summary %> <br/>
    <i><%= filter_abstract.description %></i>
    </td><td valign='top'>
    <% if ( subscription ) 
         deliveryid = subscription.delivery.id
         delayid = subscription.delay.id
         simple_subscriptions += 1
       else
         deliveryid = nil
         delayid = nil
    end %>
    <%= select_tag "#{abstraction.id}||#{filter_abstract.id}||delivery", options_for_select(@avail_deliveries, deliveryid) %>
    </td><td valign='top'>
    <%= select_tag "#{abstraction.id}||#{filter_abstract.id}||delay", options_for_select(@avail_delays, delayid) %>
    </td>
    </tr>
  <% end %>
  </table>
  
  <% end %>
  
  </td></tr>
 
  <% end %>
  <tr><td colspan="5"><%= submit_tag "Save settings" %></td></tr>
  <% end %>

  </table>
<br/>

<% if ( @subscribedMsgs.size > simple_subscriptions ) %>  

You have <%= pluralize((@subscribedMsgs.size - simple_subscriptions), "additional subscription") %> that can only be changed in the 
<a href="<%= url_for(:controller => "subscriptions" , :action => "index") %>">expert interface</a>. 

<% else %>

You can choose from a list of default notifications here. 
To configure more complex notifications, please use the 
<a href="<%= url_for(:controller => "subscriptions" , :action => "index") %>">expert interface</a>. 

<% end %>